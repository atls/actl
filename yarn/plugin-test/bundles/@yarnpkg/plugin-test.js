/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-test",
factory: function (require) {
"use strict";var plugin=(()=>{var F=Object.create;var B=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var c=(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(t,s)=>(typeof require<"u"?require:t)[s]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+o+'" is not supported')});var Y=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports),Z=(o,t)=>{for(var s in t)B(o,s,{get:t[s],enumerable:!0})},v=(o,t,s,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of k(t))!O.call(o,i)&&i!==s&&B(o,i,{get:()=>t[i],enumerable:!(n=U(t,i))||n.enumerable});return o};var L=(o,t,s)=>(s=o!=null?F(I(o)):{},v(t||!o||!o.__esModule?B(s,"default",{value:o,enumerable:!0}):s,o)),$=o=>v(B({},"__esModule",{value:!0}),o);var S=Y(g=>{"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.fastHashCode=void 0;function R(o,t={}){let{forcePositive:s=!1,caseSensitive:n=!0,seed:i=0}=t;n||(o=o.toLowerCase());let e=i,a;for(a=0;a<o.length;a++)e=(e<<5)-e+o.charCodeAt(a),e|=0;return s&&(e=e&2147483647),e}g.fastHashCode=R;g.default=R});var _={};Z(_,{TestIntegrationCommand:()=>u,TestUnitCommand:()=>w,default:()=>V});var T=c("node:path"),W=c("@yarnpkg/cli"),X=c("@yarnpkg/core"),q=c("@yarnpkg/core"),E=c("@yarnpkg/core"),p=c("clipanion");var j=c("node:fs/promises"),x=c("node:fs/promises"),C=c("node:fs/promises"),m=c("node:path"),b=c("node:path"),G=c("node:worker_threads"),P=L(S(),1),d=class{static async run(t,s,n){let i=await d.build(t,s,n);return new Promise((e,a)=>{let r=f=>{f!==0&&a(new Error(`Worker stopped with exit code ${f}`))};i.once("message",f=>{i.off("error",a),i.off("exit",r),e(f)}),i.once("error",a),i.once("exit",r)})}static async watch(t,s,n,i){let e=await d.build(t,s,n);return new Promise((a,r)=>{let f=A=>{e.stdin&&e.stdin.write(A)},D=A=>{process.stdin.off("data",f),A!==0?r(new Error(`Worker stopped with exit code ${A}`)):a()};process.stdin.on("data",f),e.on("message",i),e.once("error",r),e.once("exit",D)})}static async build(t,s,n){let i=(0,P.fastHashCode)(s,{forcePositive:!0}),e=(0,m.join)(t,`.yarn/dist/${i}.mjs`);try{try{await(0,x.access)((0,b.dirname)(e))}catch{await(0,C.mkdir)((0,b.dirname)(e),{recursive:!0})}await(0,x.access)(e)}catch{await(0,j.writeFile)(e,s)}let a=[];this.silenceWarnings(a);try{await(0,x.access)((0,m.join)(t,".pnp.cjs")),a.push("--require"),a.push((0,m.join)(t,".pnp.cjs"))}catch{}try{await(0,x.access)((0,m.join)(t,".pnp.cjs")),a.push("--loader"),a.push((0,m.join)(t,".pnp.loader.mjs"))}catch{}return new G.Worker(e,{execArgv:[...a,...process.execArgv],workerData:n,env:process.env,stdin:!0})}static silenceWarnings(t){let s="--no-warnings=",n="ExperimentalWarning";t.push(s+n)}};var H=c("node:zlib"),y,M=()=>(typeof y>"u"&&(y=(0,H.brotliDecompressSync)(Buffer.from("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","base64")).toString()),y);var h=class{constructor(t){this.cwd=t}async run(t,s,n,i){return i?.[0]===""&&i?.shift(),d.run(this.cwd,M(),{cwd:t,type:s,options:n,files:i})}};var u=class extends W.BaseCommand{constructor(){super(...arguments);this.bail=p.Option.Boolean("-b,--bail",!1);this.updateSnapshot=p.Option.Boolean("-u,--update-shapshot",!1);this.findRelatedTests=p.Option.Boolean("--find-related-tests",!1);this.watchMode=p.Option.Boolean("--watch");this.watchAllMode=p.Option.Boolean("--watchAll");this.files=p.Option.Rest({required:0})}async execute(){let s=await q.Configuration.find(this.context.cwd,this.context.plugins),{project:n,workspace:i}=await E.Project.find(s,this.context.cwd),e=[];if(i)if(this.files?.length>0){let r=this.context.cwd.replace(n.cwd,"");this.files.forEach(f=>e.push((0,T.join)(r.startsWith("/")?r.slice(1):r,f)))}else{let r=this.context.cwd.replace(n.cwd,"");e.push(r.startsWith("/")?r.slice(1):r)}else this.files?.length>0&&this.files.forEach(r=>e.push(r));return(await X.StreamReport.start({stdout:this.context.stdout,configuration:s},async()=>{await new h(n.cwd).run(this.context.cwd,"integration",{findRelatedTests:this.findRelatedTests,updateSnapshot:this.updateSnapshot,bail:this.bail,watch:this.watchMode,watchAll:this.watchAllMode},e)})).exitCode()}};u.paths=[["test","integration"]];var N=c("node:path"),z=c("@yarnpkg/cli"),J=c("@yarnpkg/core"),K=c("@yarnpkg/core"),Q=c("@yarnpkg/core"),l=c("clipanion");var w=class extends z.BaseCommand{constructor(){super(...arguments);this.bail=l.Option.Boolean("-b,--bail",!1);this.updateSnapshot=l.Option.Boolean("-u,--update-shapshot",!1);this.findRelatedTests=l.Option.Boolean("--find-related-tests",!1);this.watchMode=l.Option.Boolean("--watch");this.watchAllMode=l.Option.Boolean("--watchAll");this.files=l.Option.Rest({required:0})}async execute(){let s=await K.Configuration.find(this.context.cwd,this.context.plugins),{project:n,workspace:i}=await Q.Project.find(s,this.context.cwd),e=[];if(i)if(this.files?.length>0){let r=this.context.cwd.replace(n.cwd,"");this.files.forEach(f=>e.push((0,N.join)(r.startsWith("/")?r.slice(1):r,f)))}else{let r=this.context.cwd.replace(n.cwd,"");e.push(r.startsWith("/")?r.slice(1):r)}else this.files?.length>0&&this.files.forEach(r=>e.push(r));return(await J.StreamReport.start({stdout:this.context.stdout,configuration:s},async()=>{await new h(n.cwd).run(this.context.cwd,"unit",{findRelatedTests:this.findRelatedTests,updateSnapshot:this.updateSnapshot,bail:this.bail,watch:this.watchMode,watchAll:this.watchAllMode},e)})).exitCode()}};w.paths=[["test","unit"]];var V={commands:[u,w]};return $(_);})();
return plugin;
}
};
