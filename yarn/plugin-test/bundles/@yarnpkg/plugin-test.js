/* eslint-disable */
//prettier-ignore
module.exports = {
name: "@yarnpkg/plugin-test",
factory: function (require) {
"use strict";var plugin=(()=>{var z=Object.create;var h=Object.defineProperty;var K=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var H=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var s=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var X=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),B=(e,t)=>{for(var r in t)h(e,r,{get:t[r],enumerable:!0})},S=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of C(t))!V.call(e,o)&&o!==r&&h(e,o,{get:()=>t[o],enumerable:!(i=K(t,o))||i.enumerable});return e};var T=(e,t,r)=>(r=e!=null?z(H(e)):{},S(t||!e||!e.__esModule?h(r,"default",{value:e,enumerable:!0}):r,e)),W=e=>S(h({},"__esModule",{value:!0}),e);var L=X((F,A)=>{"use strict";var R;A.exports.getContent=()=>(typeof R>"u"&&(R=s("zlib").brotliDecompressSync(Buffer.from("G5wUQBwHdpNPM34KObriNf9dat1zOb2pwJjgLRXCltasyELxzywp2AKS7gZRMOubID0+fv3edxMZ6LpLlP5GohR/z5Z5fdJa33fTuqRUhcwgDB4rQZv6GmprpvmpgkwLabpyr6dLHkPhcV3ZSbG2jaEEi7l6zhpU0ORSHvqUKcSJa0UMhJ+p2E2kr1Kj1iczKr9VundWU/RuLrd97vIiYY6HcASyrvLqBHwi8gC5EnILHF57tzSEKY+rcoA2OXhDh3Z+rFg2lzY/3RXaX/09LMPMDRiZNRWzenKDzpagNVrOeKMBlGUwykYkL0c7mJRtqqKKJmXay1lHci4eOMxPCtnwCA3/XjCqNoe27WDx+uzEGu231sjI6EywEz108YE/1fGutlMejzx+yzjqVD9cHwiR6OSJ0A4kGJFOPy3d7XsH2nQiZxdEtzjaK1TZ2MjNdJGcd1h7YBC9ELb1sOkfhtv1fEEZc4LdWNEMOSikgzslfVW9tFt8w9hhhNvqXx1FIXDrczJvXV/tbrVYGRSSmqp5NY1je5SwYtbn+rzUI5hMqknwHEHKgGZNZQ80Tqcn8hhT/13i9UcE4iZg98g1TWGejNQmWGuzWshP4sVvmUtOqwRPVFR3LeMeY9b/RsPp7p3E59s3RDXWM5cIAjg/gVMH2Hxiqbsl9ocUUsN0rFe80zJ4c8cW1amiB+8K1FR5XeyDAjZUbA8SRNDNTlAkEZEg6THdvtsT5RccpRzCVm7Kdo3k8Kj1GTRnZQlIxxA3+wS+QZUoV6USHBOTwkX+jfVLE+2TKD8nRSrQZxPsaCqNjaSbklBL1/HhBl2WnYRxSLLBdd3nsP114Hgcz7Ra3SI8jpgDSOnrjwc+GaOMGBhpmr+TYHF3kgZBnROQKrj/wJimYqqXGLNbLzXbA6k+qKwlAG+I8vB6E6Gxa22IAebNCv0c4irmNs4DazJvV8+YvEaGN43g3ZEFH8xFP9bQS1ZOvMFwzkFU4l5TsB2Jer780XVG+Ucr5bE9W/FPW1CGh1UkyrOXKEsbk5p6LuARtdR/W5FQf+KLORge5B6jW0np1F8NQjLOkqPe9qakDu5DeU9RjCd9CLnpFKsYCkS0gVbqmczK2tiYNbYUUW5H+Jx2XlscBn8lT0uPg0H9i6m23s0UmSaVNbJCHXhwIhm+Y4bhiND2LjC7/imPZPMyiwCpgv5FCatcEIOKYwbcfNtmbc1DTu014JDg7GIHXOv5C3eW9P6FTLrtB6VyMGAJ0rI28smm4QpZULWkDdZP1WO9T+vr83/qHoXuBtAcd+LQ4JY338Xg912YNA4oxNuVpEeGohyUcxuhAPkIbY1wObNuJBVKiUTrP1QU1urH9/rdy+8/6hdvv1++94n618tv9UWEf/XbAKzT9KgUbCDlq1FCOOaPv5enWiJlAVh8zpasIhuUTlVI/bDMcUluUiL/HlROp0LgMWBt1DkuKez/QS6mJIf6mmVMNh8OuM2svJKQP3Xxev1AieXMCx819OoUmU9etehXN5Rpkj+Qm6c6OnoGn6xtsAXSuaHP4QVdjZeXuUwNJYrkEEFISkLpKCNNn9p65NZKesMqlNc/2x2/JARLgtHEt+ltSLcDGFiEsd5eV24k/eoApVSuFivpxrKUjfNJL+Sypds+b8P1ZetxV3rfWPbT3cfbLu00lU6HF2BTWzXUejk8n8OhlFM/4lS7KC47HAS+qYflNs6nnetUXIXnH95yxXZLlR7TsbPLk0IfN17sk/e/ozN7qg/Bpz2K39+1fY/mpIdF9X8JR/dC/pfw9+LLiuiSgsHEAh6PKBed7bZELVUFUy9cdgZZmqMXRNIcynDoUmqRptyGc5r49OwLmvAY9nQVQOS6fq9DU4MJO23SoIyzitRhV9p56SVtGlFa0CjLVVOe4Jk5GKLqp6C2zMYvibRiPzTS9WRPb8TYsVyULAdzAA==","base64")).toString()),R)});var Z={};B(Z,{TestIntegrationCommand:()=>m,TestUnitCommand:()=>l,default:()=>j});var U=s("@yarnpkg/cli"),k=s("@yarnpkg/core"),v=s("@yarnpkg/core"),y=s("@yarnpkg/core"),f=s("clipanion");var w=s("path"),x=s("worker_threads"),g=class{static async run(t,r){return new Promise((i,o)=>{let a=process.versions.pnp?s("module").findPnpApi(__filename).resolveRequest("pnpapi",null):(0,w.join)(process.cwd(),".pnp.cjs"),p=new x.Worker(t,{eval:!0,execArgv:["--require",a,...process.execArgv],workerData:r}),n=c=>{c!==0&&o(new Error(`Worker stopped with exit code ${c}`))};p.once("message",c=>{p.off("error",o),p.off("exit",n),i(c)}),p.once("error",o),p.once("exit",n)})}static async watch(t,r,i){return new Promise((o,a)=>{let p=process.versions.pnp?s("module").findPnpApi(__filename).resolveRequest("pnpapi",null):(0,w.join)(process.cwd(),".pnp.cjs"),n=new x.Worker(t,{eval:!0,execArgv:["--require",p,...process.execArgv],workerData:r}),c=b=>{b!==0?a(new Error(`Worker stopped with exit code ${b}`)):o(null)};n.on("message",i),n.once("error",a),n.once("exit",c)})}};var P=T(L()),d=class{constructor(t){this.cwd=t}async run(t,r,i){return g.run((0,P.getContent)(),{cwd:this.cwd,type:t,options:r,files:i})}};var m=class extends U.BaseCommand{constructor(){super(...arguments);this.bail=f.Option.Boolean("-b,--bail",!1);this.updateSnapshot=f.Option.Boolean("-u,--update-shapshot",!1);this.findRelatedTests=f.Option.Boolean("--find-related-tests",!1);this.files=f.Option.Rest({required:0})}async execute(){let r=await v.Configuration.find(this.context.cwd,this.context.plugins),{project:i,workspace:o}=await y.Project.find(r,this.context.cwd),a=[];if(o){let n=this.context.cwd.replace(i.cwd,"");a.push(n.startsWith("/")?n.substr(1):n)}return(await k.StreamReport.start({stdout:this.context.stdout,configuration:r},async()=>{await new d(i.cwd).run("integration",{findRelatedTests:this.findRelatedTests,updateSnapshot:this.updateSnapshot,bail:this.bail},a.concat(this.files))})).exitCode()}};m.paths=[["test","integration"]];var N=s("@yarnpkg/cli"),q=s("@yarnpkg/core"),E=s("@yarnpkg/core"),O=s("@yarnpkg/core"),u=s("clipanion");var l=class extends N.BaseCommand{constructor(){super(...arguments);this.bail=u.Option.Boolean("-b,--bail",!1);this.updateSnapshot=u.Option.Boolean("-u,--update-shapshot",!1);this.findRelatedTests=u.Option.Boolean("--find-related-tests",!1);this.files=u.Option.Rest({required:0})}async execute(){let r=await E.Configuration.find(this.context.cwd,this.context.plugins),{project:i,workspace:o}=await O.Project.find(r,this.context.cwd),a=[];if(o){let n=this.context.cwd.replace(i.cwd,"");a.push(n.startsWith("/")?n.substr(1):n)}return(await q.StreamReport.start({stdout:this.context.stdout,configuration:r},async()=>{await new d(i.cwd).run("unit",{findRelatedTests:this.findRelatedTests,updateSnapshot:this.updateSnapshot,bail:this.bail},a.concat(this.files))})).exitCode()}};l.paths=[["test","unit"]];var j={commands:[m,l]};return W(Z);})();
return plugin;
}
};
